(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))o(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const l of s.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&o(l)}).observe(document,{childList:!0,subtree:!0});function c(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function o(n){if(n.ep)return;n.ep=!0;const s=c(n);fetch(n.href,s)}})();const $="modulepreload",T=function(t){return"/"+t},S={},A=function(r,c,o){let n=Promise.resolve();if(c&&c.length>0){document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),i=(l==null?void 0:l.nonce)||(l==null?void 0:l.getAttribute("nonce"));n=Promise.allSettled(c.map(g=>{if(g=T(g),g in S)return;S[g]=!0;const d=g.endsWith(".css"),m=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${g}"]${m}`))return;const f=document.createElement("link");if(f.rel=d?"stylesheet":$,d||(f.as="script"),f.crossOrigin="",f.href=g,i&&f.setAttribute("nonce",i),document.head.appendChild(f),d)return new Promise((p,y)=>{f.addEventListener("load",p),f.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${g}`)))})}))}function s(l){const i=new Event("vite:preloadError",{cancelable:!0});if(i.payload=l,window.dispatchEvent(i),!i.defaultPrevented)throw l}return n.then(l=>{for(const i of l||[])i.status==="rejected"&&s(i.reason);return r().catch(s)})},a={toast:document.getElementById("toast"),modeSwitcher:document.getElementById("mode-switcher"),layoutModeBtn:document.getElementById("layout-mode-btn"),stitchingModeBtn:document.getElementById("stitching-mode-btn"),layoutWrapper:document.getElementById("layout-wrapper"),layoutGrid:document.getElementById("layout-grid"),stitchingWrapper:document.getElementById("stitching-wrapper"),stitchingGrid:document.getElementById("stitching-grid"),layoutControls:document.getElementById("layout-controls"),stitchingControls:document.getElementById("stitching-controls"),layoutContainer:document.getElementById("layout-container"),stitchingDirectionBtns:document.getElementById("stitching-direction-btns"),stitchingUploadBtn:document.getElementById("stitching-upload-btn"),stitchingUploadInput:document.getElementById("stitching-upload-input"),canvasSettings:document.getElementById("canvas-settings"),aspectRatioBtns:document.getElementById("aspect-ratio-btns"),spacingSlider:document.getElementById("spacing-slider"),spacingValue:document.getElementById("spacing-value"),radiusSlider:document.getElementById("radius-slider"),radiusValue:document.getElementById("radius-value"),colorPicker:document.getElementById("color-picker"),shuffleBtn:document.getElementById("shuffle-btn"),downloadBtn:document.getElementById("download-btn")},b=(t,r)=>{const c=document.createElement(t);return r&&(c.className=r),c},D={upload:'<div class="upload-icon"><svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" fill="currentColor" viewBox="0 0 256 256"><path d="M128,24A104,104,0,1,0,232,128,104.11,104.11,0,0,0,128,24Zm0,192a88,88,0,1,1,88-88A88.1,88.1,0,0,1,128,216Zm48-88a8,8,0,0,1-8,8H136v32a8,8,0,0,1-16,0V136H88a8,8,0,0,1,0-16h32V88a8,8,0,0,1,16,0v32h32A8,8,0,0,1,176,128Z"></path></svg></div>',remove:'<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd" /></svg>'},e={currentMode:"layout",canvasBackgroundImage:null,currentLayoutId:"2-t1b1",imagesData:{},colFractions:[],rowFractions:[],stitchingImages:[],stitchingDirection:"horizontal"};function W(t){e.currentLayoutId=t}const w={"2-t1b1":{g:2,gr:[2,1],c:[{r:1,c:1},{r:1,c:1}]},"2-l1r1":{g:2,gr:[1,2],c:[{r:1,c:1},{r:1,c:1}]},"3-t1b2":{g:3,gr:[2,2],c:[{r:1,c:2},{r:1,c:1},{r:1,c:1}]},"3-t2b1":{g:3,gr:[2,2],c:[{r:1,c:1},{r:1,c:1},{r:1,c:2}]},"3-l1r2":{g:3,gr:[2,2],c:[{r:2,c:1},{r:1,c:1},{r:1,c:1}]},"3-l2r1":{g:3,gr:[2,2],c:[{r:1,c:1},{r:2,c:1},{r:1,c:1}]},"3-l1rr":{g:3,gr:[3,3],c:[{r:3,c:2},{r:1,c:1},{r:2,c:1}]},"3-t1bb":{g:3,gr:[3,3],c:[{r:2,c:3},{r:1,c:1},{r:1,c:2}]},"4-grid":{g:4,gr:[2,2]},"4-t1b3":{g:4,gr:[2,3],c:[{r:1,c:3},{r:1,c:1},{r:1,c:1},{r:1,c:1}]},"4-b1t3":{g:4,gr:[2,3],c:[{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:3}]},"4-l1r3":{g:4,gr:[3,2],c:[{r:3,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1}]},"4-l-feat":{g:4,gr:[2,3],c:[{r:2,c:1},{r:1,c:2},{r:1,c:1},{r:1,c:1}]},"4-r-feat":{g:4,gr:[2,3],c:[{r:1,c:2},{r:2,c:1},{r:1,c:1},{r:1,c:1,s:[2,1]}]},"4-121":{g:4,gr:[3,2],c:[{r:1,c:2},{r:1,c:1},{r:1,c:1},{r:1,c:2}]},"4-212":{g:4,gr:[2,3],c:[{r:2,c:1},{r:1,c:1},{r:2,c:1},{r:1,c:1}]},"4-g3x2-alt":{g:4,gr:[3,2],c:[{r:2,c:1},{r:1,c:1,s:[3,1]},{r:1,c:1,s:[1,2]},{r:2,c:1,s:[2,2]}]},"5-center":{g:5,gr:[3,3],c:[{r:1,c:2},{r:2,c:1},{r:2,c:1},{r:1,c:1},{r:1,c:2}]},"5-l3r2":{g:5,gr:[3,3],c:[{r:1,c:1},{r:1,c:2},{r:1,c:1},{r:2,c:2},{r:1,c:1}]},"5-131":{g:5,gr:[3,3],c:[{r:3,c:1},{r:1,c:1},{r:3,c:1},{r:1,c:1},{r:1,c:1}]},"5-l2r3":{g:5,gr:[3,2],c:[{r:2,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1}]},"5-t2b3":{g:5,gr:[2,3],c:[{r:1,c:2},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1}]},"5-center-h-bar":{g:5,gr:[3,2],c:[{r:1,c:1},{r:1,c:1,s:[1,2]},{r:1,c:2,s:[2,1]},{r:1,c:1,s:[3,1]},{r:1,c:1,s:[3,2]}]},"5-t2b3-split":{g:5,gr:[2,6],c:[{r:1,c:3},{r:1,c:3},{r:1,c:2},{r:1,c:2},{r:1,c:2}]},"5-l1r4-col":{g:5,gr:[4,2],c:[{r:4,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1}]},"5-t-feat-r":{g:5,gr:[2,3],c:[{r:1,c:1},{r:1,c:2},{r:1,c:1},{r:1,c:1},{r:1,c:1}]},"5-t1b4-grid":{g:5,gr:[3,2],c:[{r:1,c:2},{r:1,c:1,s:[2,1]},{r:1,c:1,s:[2,2]},{r:1,c:1,s:[3,1]},{r:1,c:1,s:[3,2]}]},"5-r1l4-col":{g:5,gr:[4,2],c:[{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:4,c:1,s:[1,2]}]},"5-cross-center":{g:5,gr:[3,3],c:[{r:1,c:3},{r:1,c:1,s:[2,1]},{r:1,c:1,s:[2,2]},{r:1,c:1,s:[2,3]},{r:1,c:3,s:[3,1]},{r:1,c:1,s:[2,2]}]},"5-l-tall-r-split":{g:5,gr:[3,3],c:[{r:3,c:1},{r:1,c:2},{r:1,c:1,s:[2,2]},{r:1,c:1,s:[2,3]},{r:1,c:2,s:[3,2]}]},"5-213":{g:5,gr:[2,3],c:[{r:1,c:3},{r:1,c:1},{r:1,c:1},{r:1,c:1}]},"5-123":{g:5,gr:[2,3],c:[{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:3}]},"6-g3x2":{g:6,gr:[3,2]},"6-g2x3":{g:6,gr:[2,3]},"6-center":{g:6,gr:[4,4],c:[{r:1,c:3},{r:2,c:1},{r:3,c:1},{r:2,c:2},{r:2,c:1},{r:1,c:2}]},"6-123":{g:6,gr:[3,6],c:[{r:1,c:6},{r:1,c:3},{r:1,c:3},{r:1,c:2},{r:1,c:2},{r:1,c:2}]},"6-321":{g:6,gr:[3,6],c:[{r:1,c:2},{r:1,c:2},{r:1,c:2},{r:1,c:3},{r:1,c:3},{r:1,c:6}]},"6-231":{g:6,gr:[3,6],c:[{r:1,c:3},{r:1,c:3},{r:1,c:2},{r:1,c:2},{r:1,c:2},{r:1,c:6}]},"6-222":{g:6,gr:[3,3],c:[{r:1,c:2},{r:1,c:1},{r:1,c:1},{r:1,c:2},{r:1,c:2},{r:1,c:1}]},"6-1133":{g:6,gr:[4,3],c:[{r:2,c:3},{r:1,c:1},{r:1,c:1},{r:2,c:1},{r:1,c:1},{r:1,c:1}]},"6-223r":{g:6,gr:[3,3],c:[{r:2,c:2},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1}]},"6-223l":{g:6,gr:[3,3],c:[{r:1,c:1},{r:2,c:2},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1}]},"6-114":{g:6,gr:[3,5],c:[{r:2,c:5},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1}]},"6-3333":{g:6,gr:[4,4],c:[{r:2,c:2},{r:2,c:1},{r:2,c:1},{r:2,c:1},{r:2,c:1},{r:2,c:2}]},"7-main":{g:7,gr:[4,4],c:[{r:2,c:2},{r:2,c:2},{r:2,c:2},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1}]},"7-h-center-band":{g:7,gr:[3,3],c:[{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:3},{r:1,c:1},{r:1,c:1},{r:1,c:1}]},"7-w-center-band":{g:7,gr:[3,3],c:[{r:1,c:1},{r:3,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1}]},"7-feat-l":{g:7,gr:[4,2],c:[{r:2,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1}]},"7-feat-t":{g:7,gr:[4,2],c:[{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:2,c:1},{r:1,c:1}]},"7-311":{g:7,gr:[3,3],c:[{r:1,c:3},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1}]},"7-113":{g:7,gr:[3,3],c:[{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:3}]},"7-232":{g:7,gr:[3,6],c:[{r:1,c:3},{r:1,c:3},{r:1,c:2},{r:1,c:2},{r:1,c:2},{r:1,c:3},{r:1,c:3}]},"7-124":{g:7,gr:[3,4],c:[{r:2,c:3},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1}]},"7-323":{g:7,gr:[3,4],c:[{r:1,c:1},{r:2,c:3},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1}]},"7-313":{g:7,gr:[4,3],c:[{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:3,c:2},{r:1,c:1},{r:1,c:1},{r:1,c:1}]},"7-331":{g:7,gr:[3,4],c:[{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:2,c:3},{r:1,c:1},{r:1,c:1}]},"7-233":{g:7,gr:[4,6],c:[{r:2,c:3},{r:2,c:3},{r:1,c:2},{r:2,c:2},{r:1,c:2},{r:1,c:2},{r:1,c:2}]},"7-333":{g:7,gr:[3,3],c:[{r:1,c:1},{r:1,c:2},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:2}]},"7-346":{g:7,gr:[4,6],c:[{r:1,c:2},{r:2,c:2},{r:2,c:2},{r:1,c:2},{r:2,c:3},{r:1,c:3},{r:1,c:3}]},"8-g4x2":{g:8,gr:[4,2]},"8-g2x4":{g:8,gr:[2,4]},"8-222":{g:8,gr:[4,4],c:[{r:1,c:2},{r:2,c:1},{r:2,c:1},{r:1,c:2},{r:2,c:1},{r:2,c:1},{r:1,c:2},{r:1,c:2}]},"8-l2-tall-r6-grid":{g:8,gr:[3,4],c:[{r:3,c:1},{r:1,c:1},{r:1,c:1},{r:3,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1}]},"8-sandwich-6":{g:8,gr:[4,3],c:[{r:1,c:3},{r:1,c:1,s:[2,1]},{r:1,c:1,s:[2,2]},{r:1,c:1,s:[2,3]},{r:1,c:1,s:[3,1]},{r:1,c:1,s:[3,2]},{r:1,c:1,s:[3,3]},{r:1,c:3,s:[4,1]}]},"8-313":{g:8,gr:[5,4],c:[{r:2,c:2},{r:2,c:2},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:2,c:2},{r:2,c:2}]},"8-131":{g:8,gr:[4,5],c:[{r:2,c:2},{r:1,c:1},{r:2,c:2},{r:1,c:1},{r:2,c:2},{r:1,c:1},{r:2,c:2},{r:1,c:1}]},"8-134":{g:8,gr:[4,4],c:[{r:3,c:3},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1}]},"8-431":{g:8,gr:[4,4],c:[{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:3,c:3},{r:1,c:1},{r:1,c:1}]},"8-323":{g:8,gr:[3,6],c:[{r:1,c:2},{r:1,c:2},{r:1,c:2},{r:1,c:3},{r:1,c:3},{r:1,c:2},{r:1,c:2},{r:1,c:2}]},"8-363":{g:8,gr:[6,3],c:[{r:2,c:1},{r:3,c:1},{r:2,c:1},{r:2,c:1},{r:2,c:1},{r:3,c:1},{r:2,c:1},{r:2,c:1}]},"8-344":{g:8,gr:[4,4],c:[{r:1,c:1},{r:2,c:1},{r:2,c:2},{r:1,c:1},{r:2,c:2},{r:2,c:1},{r:1,c:1},{r:1,c:1}]},"9-grid":{g:9,gr:[3,3]},"9-144-grid":{g:9,gr:[3,4],c:[{r:1,c:4},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1}]},"9-414-grid":{g:9,gr:[3,4],c:[{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:4},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1}]},"9-441-grid":{g:9,gr:[3,4],c:[{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:4}]},"9-211-grid":{g:9,gr:[3,4],c:[{r:2,c:2},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1}]},"9-112-grid":{g:9,gr:[3,4],c:[{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:2,c:2},{r:1,c:1},{r:1,c:1}]},"9-434-grid":{g:9,gr:[4,4],c:[{r:1,c:1},{r:4,c:2},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1}]},"9-344-grid":{g:9,gr:[4,4],c:[{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:2,c:4},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1}]},"9-424-grid":{g:9,gr:[4,4],c:[{r:2,c:2},{r:2,c:1},{r:2,c:1},{r:1,c:2},{r:1,c:1},{r:1,c:1},{r:1,c:2},{r:1,c:1},{r:1,c:1}]},"9-116-grid":{g:9,gr:[6,6],c:[{r:3,c:3},{r:3,c:3},{r:3,c:3},{r:2,c:2},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1}]},"9-611-grid":{g:9,gr:[6,6],c:[{r:2,c:2},{r:1,c:1},{r:3,c:3},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:3,c:3},{r:3,c:3}]},"9-cen-grid":{g:9,gr:[4,4],c:[{r:1,c:2},{r:1,c:2},{r:2,c:1},{r:2,c:2},{r:2,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1}]},"10-g5x2":{g:10,gr:[5,2]},"10-t2b8-grid":{g:10,gr:[3,4],c:[{r:1,c:2},{r:1,c:2},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1}]},"10-424-grid":{g:10,gr:[3,4],c:[{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:2},{r:1,c:2},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1}]},"10-4x3-grid":{g:10,gr:[4,3],c:[{r:1,c:3},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1}]},"10-5x5-grid":{g:10,gr:[5,5],c:[{r:4,c:4},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1}]},"10-4x4-grid":{g:10,gr:[4,4],c:[{r:2,c:2},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:2,c:2},{r:1,c:1},{r:1,c:1}]},"10-8x8-grid":{g:10,gr:[8,8],c:[{r:4,c:4},{r:4,c:4},{r:4,c:4},{r:2,c:2},{r:2,c:2},{r:2,c:2},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1}]},"10-442-grid":{g:10,gr:[4,4],c:[{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:2,c:2},{r:2,c:2},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1}]},"10-6x6-grid":{g:10,gr:[6,6],c:[{r:2,c:2},{r:2,c:2},{r:2,c:2},{r:2,c:2},{r:1,c:2},{r:2,c:2},{r:1,c:2},{r:2,c:2},{r:2,c:2},{r:2,c:2}]},"11-4c4-t":{g:11,gr:[4,4],c:[{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:2,c:1},{r:2,c:2},{r:2,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1}]},"11-4x4-t":{g:11,gr:[4,4],c:[{r:1,c:1},{r:1,c:2},{r:1,c:1},{r:1,c:1},{r:2,c:2},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:2},{r:1,c:1}]},"11-4x6-t":{g:11,gr:[4,6],c:[{r:1,c:3},{r:1,c:3},{r:1,c:2},{r:1,c:2},{r:1,c:2},{r:1,c:2},{r:1,c:2},{r:1,c:2},{r:1,c:2},{r:1,c:2},{r:1,c:2}]},"11-feat-t":{g:11,gr:[3,5],c:[{r:1,c:5},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1}]},"11-feat-c":{g:11,gr:[3,5],c:[{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:5},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1}]},"11-feat-f":{g:11,gr:[3,5],c:[{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:5}]},"12-g4x3":{g:12,gr:[4,3]},"12-g3x4":{g:12,gr:[3,4]},"12-g6x6":{g:12,gr:[6,6],c:[{r:5,c:5},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1}]},"13-feat-c":{g:13,gr:[4,4],c:[{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:2,c:2},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1}]},"13-211":{g:13,gr:[4,4],c:[{r:2,c:2},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1}]},"13-112":{g:13,gr:[4,4],c:[{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:2,c:2},{r:1,c:1},{r:1,c:1}]},"14-g7x2":{g:14,gr:[7,2]},"14-g4x4r":{g:14,gr:[4,4],c:[{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:2},{r:1,c:1},{r:1,c:1},{r:1,c:2},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1}]},"14-g4x4c":{g:14,gr:[4,4],c:[{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:2,c:1},{r:2,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1}]},"15-g5x3":{g:15,gr:[5,3]},"15-g4x4c":{g:15,gr:[4,4],c:[{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:2},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1}]},"15-g4x4f":{g:15,gr:[4,4],c:[{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:2}]},"16-g4x4":{g:16,gr:[4,4]}};function v(t,r="success"){a.toast.textContent=t,a.toast.className="fixed bottom-5 right-5 text-white py-2 px-4 rounded-lg shadow-xl translate-x-[120%] transition-transform duration-300";const c={success:"bg-green-500",error:"bg-red-500",info:"bg-blue-500"};a.toast.classList.add(c[r]||"bg-gray-500"),a.toast.classList.remove("translate-x-[120%]"),setTimeout(()=>{a.toast.classList.add("translate-x-[120%]")},3e3)}function E(){const t=a.spacingSlider.value,r=a.radiusSlider.value,c=a.colorPicker.value;a.spacingValue.textContent=t,a.radiusValue.textContent=r;const o=e.currentMode==="layout"?a.layoutWrapper:a.stitchingWrapper,n=e.currentMode==="layout"?a.layoutGrid:a.stitchingGrid;e.canvasBackgroundImage?(o.style.backgroundImage=`url(${e.canvasBackgroundImage})`,o.style.backgroundSize="cover",o.style.backgroundPosition="center"):(o.style.backgroundImage="none",o.style.backgroundColor=c),e.currentMode==="layout"?(n.style.padding=`${t}px`,n.style.gap=`${t}px`,n.querySelectorAll(".grid-cell").forEach(s=>{s.style.borderRadius=`${r}px`})):(o.style.padding=`${t}px`,n.style.gap=`${t}px`,n.querySelectorAll("img").forEach(s=>{s.style.borderRadius=`${r}px`}))}function B(t,r,c="50% 50%"){const o=document.getElementById(t);if(!o)return;o.style.backgroundImage=`url(${r})`,o.style.backgroundPosition=c,o.classList.add("has-image");const n=o.querySelector(".upload-icon-container");n&&n.classList.add("hidden")}function R(t){const r=document.getElementById(t);if(!r)return;r.style.backgroundImage="",r.classList.remove("has-image");const c=r.querySelector(".upload-icon-container");c&&c.classList.remove("hidden")}function C(){let t=0;e.currentMode==="layout"?t=Object.keys(e.imagesData).length:t=e.stitchingImages.length,a.shuffleBtn.disabled=t<2}function P(t){if(t===e.currentMode)return;e.currentMode=t;const r=t==="layout";a.layoutControls.classList.toggle("hidden",!r),a.stitchingControls.classList.toggle("hidden",r),a.canvasSettings.classList.toggle("hidden",!r),a.layoutWrapper.classList.toggle("hidden",!r),a.stitchingWrapper.classList.toggle("hidden",r),a.layoutModeBtn.classList.toggle("active",r),a.stitchingModeBtn.classList.toggle("active",!r),C(),L()}function O(t){t!==e.stitchingDirection&&(e.stitchingDirection=t,document.querySelector("#stitching-direction-btns .active").classList.remove("active"),document.querySelector(`#stitching-direction-btns [data-direction="${t}"]`).classList.add("active"),L())}function U(t){var r,c;e.currentMode!=="layout"||t===e.currentLayoutId||((r=a.layoutContainer.querySelector(".active"))==null||r.classList.remove("active"),(c=a.layoutContainer.querySelector(`[data-layout="${t}"]`))==null||c.classList.add("active"),W(t),L())}function q(t){var c;if(e.currentMode!=="layout")return;(c=a.aspectRatioBtns.querySelector(".active"))==null||c.classList.remove("active"),t.classList.add("active");const r=t.dataset.ratio;a.layoutWrapper.style.aspectRatio=r,a.layoutWrapper.style.height="auto",a.layoutWrapper.style.minHeight="0",setTimeout(I,100)}function x(t,r=null){if(!t||t.length===0)return;const c=Array.from(t).filter(o=>o.type.startsWith("image/"));if(c.length===0){v("未选择有效的图片文件","error");return}if(e.currentMode==="layout"){const n=Array.from(document.querySelectorAll("#layout-grid .grid-cell")).map(s=>s.id).filter(s=>!e.imagesData[s]);if(n.length>0){const s=Math.min(c.length,n.length);let l=0;v(`正在填充 ${s} 个空格子...`,"info");for(let i=0;i<s;i++){const g=c[i],d=n[i],m=new FileReader;m.onload=f=>{if(e.imagesData[d]={src:f.target.result,position:"50% 50%"},B(d,e.imagesData[d].src,e.imagesData[d].position),l++,l===s){C();const p=`成功填充 ${s} 张图片。`+(c.length>s?` 已忽略 ${c.length-s} 张多余图片。`:"");v(p,"success")}},m.readAsDataURL(g)}}else if(r){const s=c[0],l=new FileReader;v("画布已满，将替换当前图片。","info"),l.onload=i=>{e.imagesData[r]={src:i.target.result,position:"50% 50%"},B(r,e.imagesData[r].src,e.imagesData[r].position),v("图片已替换","success")},l.readAsDataURL(s)}else v("没有空的格子可以放置图片","error")}else{const o=c.map(n=>new Promise(s=>{const l=new FileReader;l.onload=i=>s(i.target.result),l.readAsDataURL(n)}));Promise.all(o).then(n=>{e.stitchingImages=n,v(`成功选择 ${n.length} 张图片`,"success"),C(),L()})}}function G(){let t=0;if(e.currentMode==="layout"){const r=Object.entries(e.imagesData);if(t=r.length,t<2)return;const c=r.map(o=>o[1]);for(let o=c.length-1;o>0;o--){const n=Math.floor(Math.random()*(o+1));[c[o],c[n]]=[c[n],c[o]]}r.forEach(([o],n)=>{e.imagesData[o]=c[n],B(o,c[n].src,c[n].position)})}else{if(t=e.stitchingImages.length,t<2)return;for(let r=e.stitchingImages.length-1;r>0;r--){const c=Math.floor(Math.random()*(r+1));[e.stitchingImages[r],e.stitchingImages[c]]=[e.stitchingImages[c],e.stitchingImages[r]]}L()}t>1&&v("图片已随机排序","info")}function j(t,r){if(e.currentMode!=="layout"||!r)return;const c={...e.imagesData[t]},o={...e.imagesData[r]};c.src&&(c.position="50% 50%"),o.src&&(o.position="50% 50%"),e.imagesData[t]=o,o.src?B(t,o.src,o.position):(delete e.imagesData[t],R(t)),e.imagesData[r]=c,B(r,c.src,c.position)}function X(t){e.currentMode==="layout"&&(delete e.imagesData[t],R(t),C())}function Y(){const t=e.currentMode==="layout"?a.layoutWrapper:a.stitchingWrapper,r=e.currentMode==="layout"?a.layoutGrid:a.stitchingGrid;r.querySelectorAll(".gutter").forEach(l=>l.style.display="none"),v("正在生成高清晰度图片...","info");const c=window.getComputedStyle(t),o={backgroundColor:r.style.backgroundColor,backgroundImage:r.style.backgroundImage,backgroundSize:r.style.backgroundSize,backgroundPosition:r.style.backgroundPosition,padding:r.style.padding};r.style.backgroundColor=c.backgroundColor,r.style.backgroundImage=c.backgroundImage,r.style.backgroundSize=c.backgroundSize,r.style.backgroundPosition=c.backgroundPosition;const n=()=>{r.querySelectorAll(".gutter").forEach(l=>l.style.display="block"),Object.assign(r.style,o)},s={useCORS:!0,backgroundColor:null,scale:3};e.currentMode==="stitching"&&(r.style.padding=c.padding,r.style.boxSizing="border-box",s.width=r.scrollWidth,s.height=r.scrollHeight),html2canvas(r,s).then(l=>{n();const i=b("a");i.download=`${e.currentMode}-collage-${Date.now()}.png`,i.href=l.toDataURL("image/png"),i.click(),v("图片已成功保存！","success")}).catch(l=>{n(),console.error("截图失败:",l),v("截图失败，请重试","error")})}function z(t){if(!t||!t.type.startsWith("image/")){v("请选择有效的图片文件","error");return}const r=new FileReader;r.onload=c=>{e.canvasBackgroundImage=c.target.result,v("背景图已应用","success"),E()},r.readAsDataURL(t)}function H(){e.canvasBackgroundImage&&(e.canvasBackgroundImage=null,v("背景图已移除","info"),E())}function L(){E(),e.currentMode==="layout"?(a.layoutWrapper.classList.remove("hidden"),a.stitchingWrapper.classList.add("hidden"),_()):(a.layoutWrapper.classList.add("hidden"),a.stitchingWrapper.classList.remove("hidden"),V())}function _(){const t=a.layoutGrid;t.innerHTML="",Object.assign(t.style,{display:"grid",flexDirection:""});const r=w[e.currentLayoutId];if(!r)return;const[c,o]=r.gr;e.colFractions=Array(o).fill(1),e.rowFractions=Array(c).fill(1),t.style.gridTemplateRows=e.rowFractions.map(i=>`${i}fr`).join(" "),t.style.gridTemplateColumns=e.colFractions.map(i=>`${i}fr`).join(" ");const n=r.c||Array.from({length:c*o},()=>({r:1,c:1})),s={...e.imagesData},l={};n.forEach((i,g)=>{const d=`cell-${g}`,m=N(d);if(m.style.gridRowEnd=`span ${i.r}`,m.style.gridColumnEnd=`span ${i.c}`,i.s&&(m.style.gridRowStart=i.s[0],m.style.gridColumnStart=i.s[1]),t.appendChild(m),s[d]){l[d]=s[d];const f=l[d];B(d,f.src,f.position)}}),e.imagesData=l,setTimeout(I,100)}function V(){const t=a.stitchingGrid;t.innerHTML="",t.className="collage-grid",t.classList.add(e.stitchingDirection),e.stitchingImages.forEach((r,c)=>{const o=b("img");o.src=r,o.dataset.index=c,o.style.borderRadius=`${a.radiusSlider.value}px`,t.appendChild(o)})}function N(t){const r=b("div","grid-cell");r.id=t;const c=b("input");c.type="file",c.accept="image/*",c.id=`input-${t}`,c.multiple=!0,c.onchange=s=>x(s.target.files,t);const o=b("div","upload-icon-container");o.innerHTML=D.upload;const n=b("div","remove-image-btn");return n.innerHTML=D.remove,n.onclick=s=>{s.stopPropagation(),X(t)},r.append(o,c,n),r}function I(){const t=a.layoutGrid;if(t.querySelectorAll(".gutter").forEach(s=>s.remove()),e.currentMode!=="layout")return;const r=w[e.currentLayoutId];if(!r)return;const[c,o]=r.gr,n=t.getBoundingClientRect();if(o>1){const s=e.colFractions.map(i=>i/e.colFractions.reduce((g,d)=>g+d,0)*n.width);let l=0;for(let i=0;i<o-1;i++){l+=s[i];const g=b("div","gutter gutter-v");g.style.left=`${l}px`,g.style.height="100%",g.dataset.index=i,t.appendChild(g),F(g,"v")}}if(c>1){const s=e.rowFractions.map(i=>i/e.rowFractions.reduce((g,d)=>g+d,0)*n.height);let l=0;for(let i=0;i<c-1;i++){l+=s[i];const g=b("div","gutter gutter-h");g.style.top=`${l}px`,g.style.width="100%",g.dataset.index=i,t.appendChild(g),F(g,"h")}}}function F(t,r){t.onmousedown=function(c){c.preventDefault();const o=a.layoutGrid,n=parseInt(t.dataset.index),s=o.getBoundingClientRect(),l=function(g){if(r==="v"){const d=e.colFractions[n]+e.colFractions[n+1],m=e.colFractions.slice(0,n).reduce((u,h)=>u+h/e.colFractions.reduce((k,M)=>k+M,0)*s.width,0);let p=(g.clientX-s.left-m)/s.width*e.colFractions.reduce((u,h)=>u+h,0);p<.1&&(p=.1);let y=d-p;y<.1&&(y=.1,p=d-.1),e.colFractions[n]=p,e.colFractions[n+1]=y,o.style.gridTemplateColumns=e.colFractions.map(u=>`${u}fr`).join(" ")}else{const d=e.rowFractions[n]+e.rowFractions[n+1],m=e.rowFractions.slice(0,n).reduce((u,h)=>u+h/e.rowFractions.reduce((k,M)=>k+M,0)*s.height,0);let p=(g.clientY-s.top-m)/s.height*e.rowFractions.reduce((u,h)=>u+h,0);p<.1&&(p=.1);let y=d-p;y<.1&&(y=.1,p=d-.1),e.rowFractions[n]=p,e.rowFractions[n+1]=y,o.style.gridTemplateRows=e.rowFractions.map(u=>`${u}fr`).join(" ")}},i=function(){document.removeEventListener("mousemove",l),document.removeEventListener("mouseup",i),setTimeout(I,50)};document.addEventListener("mousemove",l),document.addEventListener("mouseup",i)}}const Z=Object.freeze(Object.defineProperty({__proto__:null,createGutters:I,renderCanvas:L},Symbol.toStringTag,{value:"Module"}));(function(){const t="img.ops-coffee.cn",r=window.location.hostname;r&&r!==t&&r!=="localhost"&&r!=="12.0.0.1"&&(window.location.href=`https://${t}`)})();function K(){a.layoutContainer.innerHTML="";const t={};for(const r in w){const c=w[r];t[c.g]||(t[c.g]=[]),t[c.g].push({id:r,...c})}Object.keys(t).sort((r,c)=>r-c).forEach(r=>{const c=b("h4","layout-group-title");c.textContent=`${r} 张图片`,a.layoutContainer.appendChild(c);const o=b("div","layout-thumbnail-grid");t[r].forEach(n=>{const s=J(n.id,n);n.id===e.currentLayoutId&&s.classList.add("active"),o.appendChild(s)}),a.layoutContainer.appendChild(o)})}function J(t,r){const c=b("div","layout-thumbnail");c.dataset.layout=t;const o=b("div","thumbnail-grid");return o.style.gridTemplateColumns=`repeat(${r.gr[1]}, 1fr)`,o.style.gridTemplateRows=`repeat(${r.gr[0]}, 1fr)`,(r.c||Array.from({length:r.gr[0]*r.gr[1]},()=>({r:1,c:1}))).forEach(s=>{const l=b("div","thumbnail-cell");l.style.gridRowEnd=`span ${s.r}`,l.style.gridColumnEnd=`span ${s.c}`,s.s&&(l.style.gridRowStart=s.s[0],l.style.gridColumnStart=s.s[1]),o.appendChild(l)}),c.appendChild(o),c}function Q(){a.layoutModeBtn.addEventListener("click",()=>P("layout")),a.stitchingModeBtn.addEventListener("click",()=>{P("stitching");const u=document.getElementById("stitching-placeholder"),h=document.getElementById("stitching-grid");u.classList.toggle("hidden",h.children.length>0)}),a.stitchingUploadBtn.addEventListener("click",()=>a.stitchingUploadInput.click()),a.stitchingUploadInput.addEventListener("change",u=>{x(u.target.files),document.getElementById("stitching-placeholder").classList.add("hidden")}),a.stitchingDirectionBtns.addEventListener("click",u=>{const h=u.target.closest("button");h&&O(h.dataset.direction)}),a.stitchingUploadBtn.addEventListener("dragover",u=>u.preventDefault()),a.stitchingUploadBtn.addEventListener("drop",u=>{u.preventDefault(),x(u.dataTransfer.files),document.getElementById("stitching-placeholder").classList.add("hidden")}),a.layoutContainer.addEventListener("click",u=>{const h=u.target.closest(".layout-thumbnail");h&&(U(h.dataset.layout),document.getElementById("left-sidebar").classList.contains("is-open")&&d())}),a.aspectRatioBtns.addEventListener("click",u=>{const h=u.target.closest("button");h&&q(h)}),a.spacingSlider.addEventListener("input",E),a.radiusSlider.addEventListener("input",E),a.colorPicker.addEventListener("input",E),a.shuffleBtn.addEventListener("click",G),a.downloadBtn.addEventListener("click",Y);const t=document.getElementById("bg-upload-input"),r=document.getElementById("upload-bg-btn"),c=document.getElementById("remove-bg-btn");r.addEventListener("click",()=>{t.click()}),t.addEventListener("change",u=>{u.target.files&&u.target.files[0]&&z(u.target.files[0])}),c.addEventListener("click",()=>{H()});let o;window.addEventListener("resize",()=>{clearTimeout(o),e.currentMode==="layout"&&(o=setTimeout(()=>{A(async()=>{const{createGutters:u}=await Promise.resolve().then(()=>Z);return{createGutters:u}},void 0).then(({createGutters:u})=>{u()})},150))});const n=document.getElementById("toggle-left-sidebar"),s=document.getElementById("toggle-right-sidebar"),l=document.getElementById("left-sidebar"),i=document.getElementById("right-sidebar"),g=document.getElementById("mobile-overlay"),d=()=>{l.classList.remove("is-open"),i.classList.remove("is-open"),g.classList.add("hidden"),document.body.classList.remove("sidebar-open")};n.addEventListener("click",u=>{u.stopPropagation(),l.classList.toggle("is-open")?(i.classList.remove("is-open"),g.classList.remove("hidden"),document.body.classList.add("sidebar-open")):d()}),s.addEventListener("click",u=>{u.stopPropagation(),i.classList.toggle("is-open")?(l.classList.remove("is-open"),g.classList.remove("hidden"),document.body.classList.add("sidebar-open")):d()}),g.addEventListener("click",d),document.getElementById("stitching-placeholder").addEventListener("click",()=>{a.stitchingUploadInput.click()});const f=document.getElementById("app-container"),p=document.getElementById("pc-toggle-left"),y=document.getElementById("pc-toggle-right");p.addEventListener("click",()=>{f.classList.toggle("left-sidebar-collapsed")}),y.addEventListener("click",()=>{f.classList.toggle("right-sidebar-collapsed")})}function rr(){const t=document.getElementById("layout-grid");let r={};function c(){r.startCell&&r.startCell.classList.remove("dragging"),r.activeCell&&r.activeCell.classList.remove("is-panning"),r={isMouseDown:!1,isPanning:!1,isDragging:!1,hasMoved:!1,startCell:null,activeCell:null,startX:0,startY:0,startBgPercentX:0,startBgPercentY:0},document.removeEventListener("mousemove",s),document.removeEventListener("mouseup",l)}function o(i,g){if(typeof i!="string")return 50;const d=i.trim();if(d.endsWith("%"))return parseFloat(d);if(d.endsWith("px"))return parseFloat(d)/g*100;switch(d){case"top":case"left":return 0;case"bottom":case"right":return 100;case"center":return 50}return 50}t.addEventListener("mousedown",i=>{if(i.button!==0)return;const g=i.target.closest(".grid-cell");!g||i.target.closest(".remove-image-btn")||(c(),r.isMouseDown=!0,r.startCell=g,r.startX=i.clientX,r.startY=i.clientY,document.addEventListener("mousemove",s),document.addEventListener("mouseup",l))});let n=null;function s(i){var g,d;if(r.isMouseDown){if(r.isPanning){const m=r.activeCell.getBoundingClientRect(),f=(i.clientX-r.startX)/m.width*100,p=(i.clientY-r.startY)/m.height*100;let y=r.startBgPercentX-f,u=r.startBgPercentY-p;y=Math.max(0,Math.min(100,y)),u=Math.max(0,Math.min(100,u)),r.activeCell.style.backgroundPosition=`${y}% ${u}%`;return}if(r.isDragging){const m=(g=document.elementFromPoint(i.clientX,i.clientY))==null?void 0:g.closest(".grid-cell");m!==n&&(n&&n.classList.remove("drag-over"),m&&m!==r.startCell&&m.classList.add("drag-over"),n=m);return}if(!r.hasMoved&&(Math.abs(i.clientX-r.startX)>5||Math.abs(i.clientY-r.startY)>5))if(r.hasMoved=!0,i.altKey&&r.startCell.classList.contains("has-image")){r.isPanning=!0,r.activeCell=r.startCell,r.activeCell.classList.add("is-panning");const m=r.activeCell.id,p=(((d=e.imagesData[m])==null?void 0:d.position)||"50% 50%").split(" "),y=r.activeCell.getBoundingClientRect();r.startBgPercentX=o(p[0],y.width),r.startBgPercentY=o(p.length>1?p[1]:p[0],y.height)}else r.startCell.classList.contains("has-image")&&(r.isDragging=!0,r.startCell.classList.add("dragging"))}}function l(i){var g;if(r.isMouseDown){if(r.isPanning){const d=r.activeCell.id;e.imagesData[d]&&(e.imagesData[d].position=r.activeCell.style.backgroundPosition)}else if(r.isDragging){const d=(g=document.elementFromPoint(i.clientX,i.clientY))==null?void 0:g.closest(".grid-cell");d&&d!==r.startCell&&j(r.startCell.id,d.id)}else r.hasMoved||r.startCell.querySelector('input[type="file"]').click();n&&(n.classList.remove("drag-over"),n=null),c()}}}function tr(){K(),Q(),rr(),a.layoutModeBtn.classList.add("active"),a.stitchingModeBtn.classList.remove("active"),a.layoutControls.classList.remove("hidden"),a.stitchingControls.classList.add("hidden"),a.canvasSettings.classList.remove("hidden");const t=a.aspectRatioBtns.querySelector('[data-ratio="1/1"]');t&&(t.classList.add("active"),a.layoutWrapper.style.aspectRatio="1/1"),L(),console.log("%c 免费在线拼图工具 %c by ops-coffee.cn ","background: #0052cc; color: #fff; padding: 5px; border-radius: 5px 0 0 5px;","background: #f4f5f7; color: #42526e; padding: 5px; border-radius: 0 5px 5px 0;"),console.log("感谢使用！如果您对这个工具有任何建议，欢迎联系我们。微信公众号搜索：运维咖啡吧")}document.addEventListener("DOMContentLoaded",tr);
