(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function r(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(o){if(o.ep)return;o.ep=!0;const i=r(o);fetch(o.href,i)}})();const yt="modulepreload",vt=function(t){return"/"+t},rt={},bt=function(e,r,n){let o=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),s=(l==null?void 0:l.nonce)||(l==null?void 0:l.getAttribute("nonce"));o=Promise.allSettled(r.map(g=>{if(g=vt(g),g in rt)return;rt[g]=!0;const d=g.endsWith(".css"),y=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${g}"]${y}`))return;const m=document.createElement("link");if(m.rel=d?"stylesheet":yt,d||(m.as="script"),m.crossOrigin="",m.href=g,s&&m.setAttribute("nonce",s),document.head.appendChild(m),d)return new Promise((h,b)=>{m.addEventListener("load",h),m.addEventListener("error",()=>b(new Error(`Unable to preload CSS for ${g}`)))})}))}function i(l){const s=new Event("vite:preloadError",{cancelable:!0});if(s.payload=l,window.dispatchEvent(s),!s.defaultPrevented)throw l}return o.then(l=>{for(const s of l||[])s.status==="rejected"&&i(s.reason);return e().catch(i)})},a={};function Lt(){Object.assign(a,{layoutModeBtn:document.getElementById("layout-mode-btn"),stitchingModeBtn:document.getElementById("stitching-mode-btn"),layoutControls:document.getElementById("layout-controls"),layoutContainer:document.getElementById("layout-container"),stitchingControls:document.getElementById("stitching-controls"),stitchingDirectionBtns:document.getElementById("stitching-direction-btns"),stitchingUploadBtn:document.getElementById("stitching-upload-btn"),stitchingUploadInput:document.getElementById("stitching-upload-input"),layoutWrapper:document.getElementById("layout-wrapper"),layoutGrid:document.getElementById("layout-grid"),stitchingWrapper:document.getElementById("stitching-wrapper"),stitchingGrid:document.getElementById("stitching-grid"),canvasHint:document.getElementById("canvas-hint"),canvasSettings:document.getElementById("canvas-settings"),aspectRatioBtns:document.getElementById("aspect-ratio-btns"),spacingSlider:document.getElementById("spacing-slider"),spacingValue:document.getElementById("spacing-value"),radiusSlider:document.getElementById("radius-slider"),radiusValue:document.getElementById("radius-value"),colorPicker:document.getElementById("color-picker"),shuffleBtn:document.getElementById("shuffle-btn"),downloadBtn:document.getElementById("download-btn"),borderTopInput:document.getElementById("border-top-input"),borderRightInput:document.getElementById("border-right-input"),borderBottomInput:document.getElementById("border-bottom-input"),borderLeftInput:document.getElementById("border-left-input"),toast:document.getElementById("toast")})}function L(t,e){const r=document.createElement(t);return e&&(r.className=e),r}const ct={upload:'<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>',remove:'<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>'},j={"2-t1b1":{g:2,gr:[2,1],c:[{r:1,c:1},{r:1,c:1}]},"2-l1r1":{g:2,gr:[1,2],c:[{r:1,c:1},{r:1,c:1}]},"3-t1b2":{g:3,gr:[2,2],c:[{r:1,c:2},{r:1,c:1},{r:1,c:1}]},"3-t2b1":{g:3,gr:[2,2],c:[{r:1,c:1},{r:1,c:1},{r:1,c:2}]},"3-l1r2":{g:3,gr:[2,2],c:[{r:2,c:1},{r:1,c:1},{r:1,c:1}]},"3-l2r1":{g:3,gr:[2,2],c:[{r:1,c:1},{r:2,c:1},{r:1,c:1}]},"3-l1rr":{g:3,gr:[3,3],c:[{r:3,c:2},{r:1,c:1},{r:2,c:1}]},"3-t1bb":{g:3,gr:[3,3],c:[{r:2,c:3},{r:1,c:1},{r:1,c:2}]},"4-grid":{g:4,gr:[2,2]},"4-t1b3":{g:4,gr:[2,3],c:[{r:1,c:3},{r:1,c:1},{r:1,c:1},{r:1,c:1}]},"4-b1t3":{g:4,gr:[2,3],c:[{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:3}]},"4-l1r3":{g:4,gr:[3,2],c:[{r:3,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1}]},"4-l-feat":{g:4,gr:[2,3],c:[{r:2,c:1},{r:1,c:2},{r:1,c:1},{r:1,c:1}]},"4-r-feat":{g:4,gr:[2,3],c:[{r:1,c:2},{r:2,c:1},{r:1,c:1},{r:1,c:1,s:[2,1]}]},"4-121":{g:4,gr:[3,2],c:[{r:1,c:2},{r:1,c:1},{r:1,c:1},{r:1,c:2}]},"4-212":{g:4,gr:[2,3],c:[{r:2,c:1},{r:1,c:1},{r:2,c:1},{r:1,c:1}]},"4-g3x2-alt":{g:4,gr:[3,2],c:[{r:2,c:1},{r:1,c:1,s:[3,1]},{r:1,c:1,s:[1,2]},{r:2,c:1,s:[2,2]}]},"5-center":{g:5,gr:[3,3],c:[{r:1,c:2},{r:2,c:1},{r:2,c:1},{r:1,c:1},{r:1,c:2}]},"5-l3r2":{g:5,gr:[3,3],c:[{r:1,c:1},{r:1,c:2},{r:1,c:1},{r:2,c:2},{r:1,c:1}]},"5-131":{g:5,gr:[3,3],c:[{r:3,c:1},{r:1,c:1},{r:3,c:1},{r:1,c:1},{r:1,c:1}]},"5-l2r3":{g:5,gr:[3,2],c:[{r:2,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1}]},"5-t2b3":{g:5,gr:[2,3],c:[{r:1,c:2},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1}]},"5-center-h-bar":{g:5,gr:[3,2],c:[{r:1,c:1},{r:1,c:1,s:[1,2]},{r:1,c:2,s:[2,1]},{r:1,c:1,s:[3,1]},{r:1,c:1,s:[3,2]}]},"5-t2b3-split":{g:5,gr:[2,6],c:[{r:1,c:3},{r:1,c:3},{r:1,c:2},{r:1,c:2},{r:1,c:2}]},"5-l1r4-col":{g:5,gr:[4,2],c:[{r:4,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1}]},"5-t-feat-r":{g:5,gr:[2,3],c:[{r:1,c:1},{r:1,c:2},{r:1,c:1},{r:1,c:1},{r:1,c:1}]},"5-t1b4-grid":{g:5,gr:[3,2],c:[{r:1,c:2},{r:1,c:1,s:[2,1]},{r:1,c:1,s:[2,2]},{r:1,c:1,s:[3,1]},{r:1,c:1,s:[3,2]}]},"5-r1l4-col":{g:5,gr:[4,2],c:[{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:4,c:1,s:[1,2]}]},"5-cross-center":{g:5,gr:[3,3],c:[{r:1,c:3},{r:1,c:1,s:[2,1]},{r:1,c:1,s:[2,2]},{r:1,c:1,s:[2,3]},{r:1,c:3,s:[3,1]},{r:1,c:1,s:[2,2]}]},"5-l-tall-r-split":{g:5,gr:[3,3],c:[{r:3,c:1},{r:1,c:2},{r:1,c:1,s:[2,2]},{r:1,c:1,s:[2,3]},{r:1,c:2,s:[3,2]}]},"5-213":{g:5,gr:[2,3],c:[{r:1,c:3},{r:1,c:1},{r:1,c:1},{r:1,c:1}]},"5-123":{g:5,gr:[2,3],c:[{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:3}]},"6-g3x2":{g:6,gr:[3,2]},"6-g2x3":{g:6,gr:[2,3]},"6-center":{g:6,gr:[4,4],c:[{r:1,c:3},{r:2,c:1},{r:3,c:1},{r:2,c:2},{r:2,c:1},{r:1,c:2}]},"6-123":{g:6,gr:[3,6],c:[{r:1,c:6},{r:1,c:3},{r:1,c:3},{r:1,c:2},{r:1,c:2},{r:1,c:2}]},"6-321":{g:6,gr:[3,6],c:[{r:1,c:2},{r:1,c:2},{r:1,c:2},{r:1,c:3},{r:1,c:3},{r:1,c:6}]},"6-231":{g:6,gr:[3,6],c:[{r:1,c:3},{r:1,c:3},{r:1,c:2},{r:1,c:2},{r:1,c:2},{r:1,c:6}]},"6-222":{g:6,gr:[3,3],c:[{r:1,c:2},{r:1,c:1},{r:1,c:1},{r:1,c:2},{r:1,c:2},{r:1,c:1}]},"6-1133":{g:6,gr:[4,3],c:[{r:2,c:3},{r:1,c:1},{r:1,c:1},{r:2,c:1},{r:1,c:1},{r:1,c:1}]},"6-223r":{g:6,gr:[3,3],c:[{r:2,c:2},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1}]},"6-223l":{g:6,gr:[3,3],c:[{r:1,c:1},{r:2,c:2},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1}]},"6-114":{g:6,gr:[3,5],c:[{r:2,c:5},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1}]},"6-3333":{g:6,gr:[4,4],c:[{r:2,c:2},{r:2,c:1},{r:2,c:1},{r:2,c:1},{r:2,c:1},{r:2,c:2}]},"7-main":{g:7,gr:[4,4],c:[{r:2,c:2},{r:2,c:2},{r:2,c:2},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1}]},"7-h-center-band":{g:7,gr:[3,3],c:[{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:3},{r:1,c:1},{r:1,c:1},{r:1,c:1}]},"7-w-center-band":{g:7,gr:[3,3],c:[{r:1,c:1},{r:3,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1}]},"7-feat-l":{g:7,gr:[4,2],c:[{r:2,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1}]},"7-feat-t":{g:7,gr:[4,2],c:[{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:2,c:1},{r:1,c:1}]},"7-311":{g:7,gr:[3,3],c:[{r:1,c:3},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1}]},"7-113":{g:7,gr:[3,3],c:[{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:3}]},"7-232":{g:7,gr:[3,6],c:[{r:1,c:3},{r:1,c:3},{r:1,c:2},{r:1,c:2},{r:1,c:2},{r:1,c:3},{r:1,c:3}]},"7-124":{g:7,gr:[3,4],c:[{r:2,c:3},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1}]},"7-323":{g:7,gr:[3,4],c:[{r:1,c:1},{r:2,c:3},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1}]},"7-313":{g:7,gr:[4,3],c:[{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:3,c:2},{r:1,c:1},{r:1,c:1},{r:1,c:1}]},"7-331":{g:7,gr:[3,4],c:[{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:2,c:3},{r:1,c:1},{r:1,c:1}]},"7-233":{g:7,gr:[4,6],c:[{r:2,c:3},{r:2,c:3},{r:1,c:2},{r:2,c:2},{r:1,c:2},{r:1,c:2},{r:1,c:2}]},"7-333":{g:7,gr:[3,3],c:[{r:1,c:1},{r:1,c:2},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:2}]},"7-346":{g:7,gr:[4,6],c:[{r:1,c:2},{r:2,c:2},{r:2,c:2},{r:1,c:2},{r:2,c:3},{r:1,c:3},{r:1,c:3}]},"8-g4x2":{g:8,gr:[4,2]},"8-g2x4":{g:8,gr:[2,4]},"8-222":{g:8,gr:[4,4],c:[{r:1,c:2},{r:2,c:1},{r:2,c:1},{r:1,c:2},{r:2,c:1},{r:2,c:1},{r:1,c:2},{r:1,c:2}]},"8-l2-tall-r6-grid":{g:8,gr:[3,4],c:[{r:3,c:1},{r:1,c:1},{r:1,c:1},{r:3,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1}]},"8-sandwich-6":{g:8,gr:[4,3],c:[{r:1,c:3},{r:1,c:1,s:[2,1]},{r:1,c:1,s:[2,2]},{r:1,c:1,s:[2,3]},{r:1,c:1,s:[3,1]},{r:1,c:1,s:[3,2]},{r:1,c:1,s:[3,3]},{r:1,c:3,s:[4,1]}]},"8-313":{g:8,gr:[5,4],c:[{r:2,c:2},{r:2,c:2},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:2,c:2},{r:2,c:2}]},"8-131":{g:8,gr:[4,5],c:[{r:2,c:2},{r:1,c:1},{r:2,c:2},{r:1,c:1},{r:2,c:2},{r:1,c:1},{r:2,c:2},{r:1,c:1}]},"8-134":{g:8,gr:[4,4],c:[{r:3,c:3},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1}]},"8-431":{g:8,gr:[4,4],c:[{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:3,c:3},{r:1,c:1},{r:1,c:1}]},"8-323":{g:8,gr:[3,6],c:[{r:1,c:2},{r:1,c:2},{r:1,c:2},{r:1,c:3},{r:1,c:3},{r:1,c:2},{r:1,c:2},{r:1,c:2}]},"8-363":{g:8,gr:[6,3],c:[{r:2,c:1},{r:3,c:1},{r:2,c:1},{r:2,c:1},{r:2,c:1},{r:3,c:1},{r:2,c:1},{r:2,c:1}]},"8-344":{g:8,gr:[4,4],c:[{r:1,c:1},{r:2,c:1},{r:2,c:2},{r:1,c:1},{r:2,c:2},{r:2,c:1},{r:1,c:1},{r:1,c:1}]},"9-grid":{g:9,gr:[3,3]},"9-144-grid":{g:9,gr:[3,4],c:[{r:1,c:4},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1}]},"9-414-grid":{g:9,gr:[3,4],c:[{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:4},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1}]},"9-441-grid":{g:9,gr:[3,4],c:[{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:4}]},"9-211-grid":{g:9,gr:[3,4],c:[{r:2,c:2},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1}]},"9-112-grid":{g:9,gr:[3,4],c:[{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:2,c:2},{r:1,c:1},{r:1,c:1}]},"9-434-grid":{g:9,gr:[4,4],c:[{r:1,c:1},{r:4,c:2},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1}]},"9-344-grid":{g:9,gr:[4,4],c:[{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:2,c:4},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1}]},"9-424-grid":{g:9,gr:[4,4],c:[{r:2,c:2},{r:2,c:1},{r:2,c:1},{r:1,c:2},{r:1,c:1},{r:1,c:1},{r:1,c:2},{r:1,c:1},{r:1,c:1}]},"9-116-grid":{g:9,gr:[6,6],c:[{r:3,c:3},{r:3,c:3},{r:3,c:3},{r:2,c:2},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1}]},"9-611-grid":{g:9,gr:[6,6],c:[{r:2,c:2},{r:1,c:1},{r:3,c:3},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:3,c:3},{r:3,c:3}]},"9-cen-grid":{g:9,gr:[4,4],c:[{r:1,c:2},{r:1,c:2},{r:2,c:1},{r:2,c:2},{r:2,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1}]},"10-g5x2":{g:10,gr:[5,2]},"10-t2b8-grid":{g:10,gr:[3,4],c:[{r:1,c:2},{r:1,c:2},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1}]},"10-424-grid":{g:10,gr:[3,4],c:[{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:2},{r:1,c:2},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1}]},"10-4x3-grid":{g:10,gr:[4,3],c:[{r:1,c:3},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1}]},"10-5x5-grid":{g:10,gr:[5,5],c:[{r:4,c:4},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1}]},"10-4x4-grid":{g:10,gr:[4,4],c:[{r:2,c:2},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:2,c:2},{r:1,c:1},{r:1,c:1}]},"10-8x8-grid":{g:10,gr:[8,8],c:[{r:4,c:4},{r:4,c:4},{r:4,c:4},{r:2,c:2},{r:2,c:2},{r:2,c:2},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1}]},"10-442-grid":{g:10,gr:[4,4],c:[{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:2,c:2},{r:2,c:2},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1}]},"10-6x6-grid":{g:10,gr:[6,6],c:[{r:2,c:2},{r:2,c:2},{r:2,c:2},{r:2,c:2},{r:1,c:2},{r:2,c:2},{r:1,c:2},{r:2,c:2},{r:2,c:2},{r:2,c:2}]},"11-4c4-t":{g:11,gr:[4,4],c:[{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:2,c:1},{r:2,c:2},{r:2,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1}]},"11-4x4-t":{g:11,gr:[4,4],c:[{r:1,c:1},{r:1,c:2},{r:1,c:1},{r:1,c:1},{r:2,c:2},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:2},{r:1,c:1}]},"11-4x6-t":{g:11,gr:[4,6],c:[{r:1,c:3},{r:1,c:3},{r:1,c:2},{r:1,c:2},{r:1,c:2},{r:1,c:2},{r:1,c:2},{r:1,c:2},{r:1,c:2},{r:1,c:2},{r:1,c:2}]},"11-feat-t":{g:11,gr:[3,5],c:[{r:1,c:5},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1}]},"11-feat-c":{g:11,gr:[3,5],c:[{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:5},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1}]},"11-feat-f":{g:11,gr:[3,5],c:[{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:5}]},"12-g4x3":{g:12,gr:[4,3]},"12-g3x4":{g:12,gr:[3,4]},"12-g6x6":{g:12,gr:[6,6],c:[{r:5,c:5},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1}]},"13-feat-c":{g:13,gr:[4,4],c:[{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:2,c:2},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1}]},"13-211":{g:13,gr:[4,4],c:[{r:2,c:2},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1}]},"13-112":{g:13,gr:[4,4],c:[{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:2,c:2},{r:1,c:1},{r:1,c:1}]},"14-g7x2":{g:14,gr:[7,2]},"14-g4x4r":{g:14,gr:[4,4],c:[{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:2},{r:1,c:1},{r:1,c:1},{r:1,c:2},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1}]},"14-g4x4c":{g:14,gr:[4,4],c:[{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:2,c:1},{r:2,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1}]},"15-g5x3":{g:15,gr:[5,3]},"15-g4x4c":{g:15,gr:[4,4],c:[{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:2},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1}]},"15-g4x4f":{g:15,gr:[4,4],c:[{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:1},{r:1,c:2}]},"16-g4x4":{g:16,gr:[4,4]}},nt="2-t1b1",c={currentMode:"layout",shared:{spacing:10,radius:8,bgColor:"#FFFFFF",backgroundImage:null,borderWidths:{top:0,right:0,bottom:0,left:0},selectedTextId:null,selectedArrowId:null},layout:{currentLayoutId:nt,layoutDef:j[nt],imagesData:{},texts:[],arrows:[],colFractions:[],rowFractions:[]},stitching:{direction:"horizontal",images:[]}};function xt(t){c.layout.currentLayoutId=t,c.layout.layoutDef=j[t]}let q=!1,M=null,N=-1;function Et(){a.stitchingControls.classList.remove("hidden"),a.stitchingWrapper.classList.remove("hidden"),document.getElementById("stitching-placeholder").classList.toggle("hidden",c.stitching.images.length>0),St()}function wt(){a.stitchingControls.classList.add("hidden"),a.stitchingWrapper.classList.add("hidden"),a.stitchingGrid.removeEventListener("mousedown",at)}function D(){const t=a.stitchingGrid;t.innerHTML="",t.className="collage-grid",t.classList.add(c.stitching.direction),c.stitching.images.length>1&&t.classList.add("is-sortable"),c.stitching.images.forEach((e,r)=>{const n=L("img");n.src=e,n.dataset.index=r,t.appendChild(n)}),it()}function It(t){const e=Array.from(t).filter(n=>n.type.startsWith("image/"));if(e.length===0){I("未选择有效的图片文件","error");return}document.getElementById("stitching-placeholder").classList.add("hidden");const r=e.map(n=>new Promise(o=>{const i=new FileReader;i.onload=l=>o(l.target.result),i.readAsDataURL(n)}));Promise.all(r).then(n=>{c.stitching.images=c.stitching.images.concat(n),I(`成功添加 ${n.length} 张图片`,"success"),D(),W()})}function Bt(){if(!(c.stitching.images.length<2)){for(let t=c.stitching.images.length-1;t>0;t--){const e=Math.floor(Math.random()*(t+1));[c.stitching.images[t],c.stitching.images[e]]=[c.stitching.images[e],c.stitching.images[t]]}D(),I("图片已随机排序","info")}}function it(){const{spacing:t,radius:e}=c.shared;a.stitchingWrapper.style.padding=`${t}px`;const r=a.stitchingGrid;r.style.gap=`${t}px`,r.querySelectorAll("img").forEach(n=>{n.style.borderRadius=`${e}px`})}function Ct(){const t=a.stitchingWrapper,e=a.stitchingGrid,r=document.createElement("div"),n=e.cloneNode(!0),o=window.getComputedStyle(t);Object.assign(r.style,{padding:o.padding,backgroundColor:o.backgroundColor,backgroundImage:o.backgroundImage,backgroundSize:o.backgroundSize,backgroundPosition:o.backgroundPosition,boxSizing:"border-box",position:"absolute",top:"-9999px",left:"-9999px"}),n.style.gap=window.getComputedStyle(e).gap,r.appendChild(n),document.body.appendChild(r);const i=()=>{document.body.removeChild(r)};return{element:r,options:{useCORS:!0,backgroundColor:null,scale:3,width:r.offsetWidth,height:r.offsetHeight},cleanup:i}}function st(t){t!==c.stitching.direction&&(c.stitching.direction=t,document.querySelector("#stitching-direction-btns .active").classList.remove("active"),document.querySelector(`#stitching-direction-btns [data-direction="${t}"]`).classList.add("active"),D())}function St(){a.stitchingGrid.addEventListener("mousedown",at)}function at(t){t.target.tagName!=="IMG"||c.stitching.images.length<2||(t.preventDefault(),q=!0,M=t.target,N=parseInt(M.dataset.index),M.classList.add("dragging"),document.addEventListener("mousemove",lt),document.addEventListener("mouseup",dt))}function lt(t){if(!q)return;const e=document.elementFromPoint(t.clientX,t.clientY),r=a.stitchingGrid;r.querySelectorAll("img.drag-over").forEach(n=>n.classList.remove("drag-over")),e&&e.tagName==="IMG"&&e!==M&&e.parentElement===r&&e.classList.add("drag-over")}function dt(t){if(!q)return;const e=a.stitchingGrid;M.classList.remove("dragging"),e.querySelectorAll("img.drag-over").forEach(n=>n.classList.remove("drag-over"));const r=document.elementFromPoint(t.clientX,t.clientY);if(r&&r.tagName==="IMG"&&r!==M&&r.parentElement===e){const n=parseInt(r.dataset.index);kt(N,n)}q=!1,M=null,N=-1,document.removeEventListener("mousemove",lt),document.removeEventListener("mouseup",dt)}function kt(t,e){const[r]=c.stitching.images.splice(t,1);c.stitching.images.splice(e,0,r),D()}const $t=Object.freeze(Object.defineProperty({__proto__:null,activate:Et,applySharedStyles:it,deactivate:wt,getDownloadOptions:Ct,processFiles:It,render:D,setDirection:st,shuffle:Bt},Symbol.toStringTag,{value:"Module"}));function Mt(){var t;(t=O())==null||t.shuffle()}function Pt(){const t=O();if(!t)return;a.layoutGrid.querySelectorAll(".gutter").forEach(o=>o.style.display="none"),I("正在生成高清晰度图片...","info");const{element:e,options:r,cleanup:n}=t.getDownloadOptions();html2canvas(e,r).then(o=>{n&&n(),a.layoutGrid.querySelectorAll(".gutter").forEach(l=>l.style.display="block");const i=document.createElement("a");i.download=`${c.currentMode}-collage-${Date.now()}.png`,i.href=o.toDataURL("image/png"),i.click(),I("图片已成功保存！","success")}).catch(o=>{n&&n(),a.layoutGrid.querySelectorAll(".gutter").forEach(i=>i.style.display="block"),console.error("截图失败:",o),I("截图失败，请重试","error")})}function Rt(t){c.currentMode==="layout"&&mt(t)}function Tt(t){c.currentMode==="stitching"&&st(t)}function Ft(t){const e=O();e&&e.processFiles&&e.processFiles(t)}function At(t){var e;c.currentMode==="layout"&&((e=a.aspectRatioBtns.querySelector(".active"))==null||e.classList.remove("active"),t.classList.add("active"),a.layoutWrapper.style.aspectRatio=t.dataset.ratio,setTimeout(()=>{var r;return(r=O())==null?void 0:r.render()},100))}function Dt(t){const e=new FileReader;e.onload=r=>{c.shared.backgroundImage=r.target.result,B()},e.readAsDataURL(t)}function Ot(){c.shared.backgroundImage=null,B()}function Wt(){if(c.currentMode!=="layout")return;const t={id:Date.now(),content:"文字",color:"#ff0000",fontSize:37,top:50,left:50};c.layout.texts.push(t),R(),P(t.id)}function P(t){var r;if(c.shared.selectedTextId===t)return;const e=c.shared.selectedTextId;if(c.shared.selectedTextId=t,e&&((r=document.getElementById(`text-container-${e}`))==null||r.classList.remove("selected")),t){const n=document.getElementById(`text-container-${t}`);if(n){n.classList.add("selected");const o=n.querySelector(".text-content");Yt(o)}}}function _(t){if(!c.shared.selectedTextId)return;const e=c.layout.texts.find(o=>o.id===c.shared.selectedTextId);if(!e)return;Object.assign(e,t);const r=document.getElementById(`text-container-${e.id}`);if(!r)return;const n=r.querySelector(".text-content");n&&(t.content&&(n.innerText=t.content),t.fontSize&&(n.style.fontSize=`${t.fontSize}px`),t.color&&(n.style.color=t.color),t.top&&(n.style.top=`${t.top}%`),t.left&&(n.style.left=`${t.left}%`))}function Xt(){var e;if(!c.shared.selectedTextId)return;const t=c.layout.texts.findIndex(r=>r.id===c.shared.selectedTextId);t>-1&&(c.layout.texts.splice(t,1),(e=document.getElementById(`text-container-${c.shared.selectedTextId}`))==null||e.remove(),P(null))}function Yt(t){if(t&&(t.focus(),typeof window.getSelection<"u"&&typeof document.createRange<"u")){const e=document.createRange();e.selectNodeContents(t),e.collapse(!1);const r=window.getSelection();r.removeAllRanges(),r.addRange(e)}}function Gt(){if(c.currentMode!=="layout")return;const t={id:Date.now(),color:"#ff0000",strokeWidth:4,rotation:0,x1:25,y1:25,x2:75,y2:75};c.layout.arrows.push(t),R(),T(t.id)}function T(t){var r,n;if(c.shared.selectedArrowId===t&&t!==null)return;const e=c.shared.selectedArrowId;c.shared.selectedArrowId=t,e&&((r=document.getElementById(`arrow-container-${e}`))==null||r.classList.remove("selected")),t&&((n=document.getElementById(`arrow-container-${t}`))==null||n.classList.add("selected"))}function G(t){if(!c.shared.selectedArrowId)return;const e=c.layout.arrows.find(r=>r.id===c.shared.selectedArrowId);e&&Object.assign(e,t)}function Ut(){if(!c.shared.selectedArrowId)return;const t=c.layout.arrows.findIndex(e=>e.id===c.shared.selectedArrowId);t>-1&&(c.layout.arrows.splice(t,1),R(),T(null))}function K(){const t=a.layoutGrid;t.querySelectorAll(".gutter").forEach(l=>l.remove());const[e,r]=c.layout.layoutDef.gr,n=t.getBoundingClientRect(),o=c.layout.rowFractions.reduce((l,s)=>l+s,0),i=c.layout.colFractions.reduce((l,s)=>l+s,0);if(r>1){const l=c.layout.colFractions.map(g=>g/i*n.width);let s=0;for(let g=0;g<r-1;g++){s+=l[g];const d=L("div","gutter gutter-v");d.style.left=`${s}px`,d.style.height="100%",d.dataset.index=g,t.appendChild(d),ot(d,"v")}}if(e>1){const l=c.layout.rowFractions.map(g=>g/o*n.height);let s=0;for(let g=0;g<e-1;g++){s+=l[g];const d=L("div","gutter gutter-h");d.style.top=`${s}px`,d.style.width="100%",d.dataset.index=g,t.appendChild(d),ot(d,"h")}}}function ot(t,e){t.onmousedown=function(r){r.preventDefault();const n=a.layoutGrid,o=parseInt(t.dataset.index),i=n.getBoundingClientRect(),l=function(g){if(e==="v"){const d=c.layout.colFractions[o]+c.layout.colFractions[o+1],y=c.layout.colFractions.slice(0,o).reduce((u,p)=>u+p/c.layout.colFractions.reduce((w,C)=>w+C,0)*i.width,0);let h=(g.clientX-i.left-y)/i.width*c.layout.colFractions.reduce((u,p)=>u+p,0);h<.1&&(h=.1);let b=d-h;b<.1&&(b=.1,h=d-.1),c.layout.colFractions[o]=h,c.layout.colFractions[o+1]=b,n.style.gridTemplateColumns=c.layout.colFractions.map(u=>`${u}fr`).join(" ")}else{const d=c.layout.rowFractions[o]+c.layout.rowFractions[o+1],y=c.layout.rowFractions.slice(0,o).reduce((u,p)=>u+p/c.layout.rowFractions.reduce((w,C)=>w+C,0)*i.height,0);let h=(g.clientY-i.top-y)/i.height*c.layout.rowFractions.reduce((u,p)=>u+p,0);h<.1&&(h=.1);let b=d-h;b<.1&&(b=.1,h=d-.1),c.layout.rowFractions[o]=h,c.layout.rowFractions[o+1]=b,n.style.gridTemplateRows=c.layout.rowFractions.map(u=>`${u}fr`).join(" ")}},s=function(){document.removeEventListener("mousemove",l),document.removeEventListener("mouseup",s),setTimeout(K,50)};document.addEventListener("mousemove",l),document.addEventListener("mouseup",s)}}const jt=Object.freeze(Object.defineProperty({__proto__:null,createGutters:K},Symbol.toStringTag,{value:"Module"}));function qt(){a.layoutControls.classList.remove("hidden"),a.canvasSettings.classList.remove("hidden"),a.layoutWrapper.classList.remove("hidden"),a.canvasHint.classList.remove("hidden")}function Ht(){a.layoutControls.classList.add("hidden"),a.canvasSettings.classList.add("hidden"),a.layoutWrapper.classList.add("hidden"),a.canvasHint.classList.add("hidden")}function R(){const t=a.layoutGrid;t.innerHTML="";const e=c.layout.layoutDef;if(!e)return;const[r,n]=e.gr;c.layout.rowFractions=Array(r).fill(1),c.layout.colFractions=Array(n).fill(1),t.style.gridTemplateRows=c.layout.rowFractions.map(s=>`${s}fr`).join(" "),t.style.gridTemplateColumns=c.layout.colFractions.map(s=>`${s}fr`).join(" ");const o=e.c||Array.from({length:r*n},()=>({r:1,c:1})),i={...c.layout.imagesData},l={};o.forEach((s,g)=>{const d=`cell-${g}`,y=Kt(d);if(y.style.gridRowEnd=`span ${s.r}`,y.style.gridColumnEnd=`span ${s.c}`,s.s&&(y.style.gridRowStart=s.s[0],y.style.gridColumnStart=s.s[1]),t.appendChild(y),i[d]){l[d]=i[d];const m=l[d];F(d,m.src,m.position)}}),c.layout.imagesData=l,c.layout.texts.forEach(s=>{zt(s)}),c.layout.arrows.forEach(s=>{_t(s)}),ut(),setTimeout(K,100)}function zt(t){const e=a.layoutGrid;if(!e)return;const r=L("div","text-element-container");r.id=`text-container-${t.id}`,Object.assign(r.style,{top:`${t.top}%`,left:`${t.left}%`});const n=L("div","text-content");n.innerText=t.content,n.contentEditable="true",Object.assign(n.style,{color:t.color,fontSize:`${t.fontSize}px`});const o=L("div","text-toolbar");o.innerHTML=`
        <input type="number" value="${t.fontSize}" data-property="fontSize" title="Font Size">
        <input type="color" value="${t.color}" data-property="color" title="Font Color">
    `;const i=L("button","delete-text-button");i.innerHTML="&times;",i.title="Delete Text",r.append(o,n,i),e.appendChild(r),r.addEventListener("click",l=>{l.stopPropagation(),P(t.id)}),o.addEventListener("mousedown",l=>l.stopPropagation()),o.addEventListener("input",l=>{const s=l.target.dataset.property;s&&_({[s]:l.target.value})}),i.addEventListener("click",l=>{l.stopPropagation(),Xt()}),n.addEventListener("blur",()=>{_({content:n.innerText})}),r.addEventListener("mousedown",l=>{if(l.target.closest(".text-toolbar"))return;l.stopPropagation(),P(t.id);const s=e.getBoundingClientRect(),g=l.clientX,d=l.clientY,y=r.offsetLeft,m=r.offsetTop;function h(u){const p=u.clientX-g,w=u.clientY-d;r.style.left=`${(y+p)/s.width*100}%`,r.style.top=`${(m+w)/s.height*100}%`}function b(){document.removeEventListener("mousemove",h),document.removeEventListener("mouseup",b),_({left:parseFloat(r.style.left),top:parseFloat(r.style.top)})}document.addEventListener("mousemove",h),document.addEventListener("mouseup",b)})}function _t(t){const e=a.layoutGrid,r=e.getBoundingClientRect(),n=r.width*(t.x1/100),o=r.height*(t.y1/100),i=r.width*(t.x2/100),l=r.height*(t.y2/100),s=Math.min(n,i),g=Math.min(o,l),d=Math.abs(n-i),y=Math.abs(o-l),m=L("div","arrow-container");m.id=`arrow-container-${t.id}`,c.shared.selectedArrowId===t.id&&m.classList.add("selected"),Object.assign(m.style,{left:`${s}px`,top:`${g}px`,width:`${d}px`,height:`${y}px`,transform:`rotate(${t.rotation||0}deg)`});const h="http://www.w3.org/2000/svg",b=document.createElementNS(h,"svg"),u=`arrowhead-${t.id}`,p=document.createElementNS(h,"line"),w=document.createElementNS(h,"polygon");b.innerHTML=`<defs><marker id="${u}" markerWidth="2.5" markerHeight="2.5" refX="2.5" refY="1.25" orient="auto" markerUnits="strokeWidth"></marker></defs>`,w.setAttribute("points","0 0, 2.5 1.25, 0 2.5"),w.setAttribute("fill",t.color),b.querySelector("marker").appendChild(w);const C=n-s,J=o-g,Q=i-s,Z=l-g;p.setAttribute("x1",C),p.setAttribute("y1",J),p.setAttribute("x2",Q),p.setAttribute("y2",Z),p.setAttribute("stroke",t.color),p.setAttribute("stroke-width",t.strokeWidth),p.setAttribute("marker-end",`url(#${u})`),b.appendChild(p);const X=L("div","arrow-handle start"),Y=L("div","arrow-handle end");X.style.left=`${C}px`,X.style.top=`${J}px`,Y.style.left=`${Q}px`,Y.style.top=`${Z}px`;const tt=L("div","rotation-handle"),A=L("div","text-toolbar");A.style.top="-45px",A.innerHTML=`<input type="number" value="${t.strokeWidth}" data-property="strokeWidth" title="Thickness" min="1" max="50"><input type="color" value="${t.color}" data-property="color" title="Color"><button class="toolbar-delete-btn" title="Delete Arrow">&times;</button>`,m.append(b,X,Y,tt,A),e.appendChild(m);function H(v){v.element&&v.element.addEventListener("mousedown",f=>{f.stopPropagation(),v.action&&v.action();const x={x:f.clientX,y:f.clientY,initialState:{...t},gridRect:e.getBoundingClientRect(),elementRect:m.getBoundingClientRect()};function E($){v.onMove($,x)}function S($){document.removeEventListener("mousemove",E),document.removeEventListener("mouseup",S),v.onUp&&v.onUp($,x)}document.addEventListener("mousemove",E),document.addEventListener("mouseup",S)})}H({element:m,action:()=>T(t.id),ignore:".arrow-handle, .rotation-handle, .text-toolbar",onMove:(v,f)=>{const x=v.clientX-f.x,E=v.clientY-f.y;m.style.left=`${f.elementRect.left-f.gridRect.left+x}px`,m.style.top=`${f.elementRect.top-f.gridRect.top+E}px`},onUp:(v,f)=>{const x=(v.clientX-f.x)/f.gridRect.width*100,E=(v.clientY-f.y)/f.gridRect.height*100;G({x1:f.initialState.x1+x,y1:f.initialState.y1+E,x2:f.initialState.x2+x,y2:f.initialState.y2+E})}});const et=(v,f)=>{H({element:v,action:()=>T(t.id),onMove:(x,E)=>{G({[f.x]:(x.clientX-E.gridRect.left)/E.gridRect.width*100,[f.y]:(x.clientY-E.gridRect.top)/E.gridRect.height*100}),R()},onUp:()=>{}})};et(X,{x:"x1",y:"y1"}),et(Y,{x:"x2",y:"y2"}),H({element:tt,action:()=>T(t.id),onMove:(v,f)=>{const x=f.elementRect,E=x.left+x.width/2,S=x.top+x.height/2,$=Math.atan2(v.clientY-S,v.clientX-E)*(180/Math.PI),z=Math.atan2(f.y-S,f.x-E)*(180/Math.PI);m.style.transform=`rotate(${f.initialState.rotation+($-z)}deg)`},onUp:(v,f)=>{const x=f.elementRect,E=x.left+x.width/2,S=x.top+x.height/2,$=Math.atan2(v.clientY-S,v.clientX-E)*(180/Math.PI),z=Math.atan2(f.y-S,f.x-E)*(180/Math.PI);G({rotation:f.initialState.rotation+($-z)})}}),A.addEventListener("input",v=>{v.stopPropagation(),G({[v.target.dataset.property]:v.target.value}),R()}),A.querySelector(".toolbar-delete-btn").addEventListener("click",v=>{v.stopPropagation(),Ut()})}function gt(t,e=null){const r=Array.from(t).filter(i=>i.type.startsWith("image/"));if(r.length===0){I("未选择有效的图片文件","error");return}const o=Array.from(document.querySelectorAll("#layout-grid .grid-cell")).map(i=>i.id).filter(i=>!c.layout.imagesData[i]);if(o.length>0){const i=Math.min(r.length,o.length);let l=0;I(`正在填充 ${i} 个空格子...`,"info");for(let s=0;s<i;s++){const g=r[s],d=o[s],y=new FileReader;y.onload=m=>{if(c.layout.imagesData[d]={src:m.target.result,position:"50% 50%"},F(d,m.target.result,"50% 50%"),l++,l===i){const h=`成功填充 ${i} 张图片。`+(r.length>i?` 已忽略 ${r.length-i} 张。`:"");I(h,"success"),W()}},y.readAsDataURL(g)}}else if(e){const i=r[0],l=new FileReader;I("画布已满，将替换当前图片。","info"),l.onload=s=>{c.layout.imagesData[e]={src:s.target.result,position:"50% 50%"},F(e,s.target.result,"50% 50%"),I("图片已替换","success")},l.readAsDataURL(i)}else I("没有空的格子可以放置图片","error")}function Nt(){const t=Object.entries(c.layout.imagesData);if(t.length<2)return;const e=t.map(r=>r[1]);for(let r=e.length-1;r>0;r--){const n=Math.floor(Math.random()*(r+1));[e[r],e[n]]=[e[n],e[r]]}t.forEach(([r],n)=>{c.layout.imagesData[r]=e[n],F(r,e[n].src,e[n].position)}),I("图片已随机排序","info")}function ut(){const{spacing:t,radius:e}=c.shared,r=a.layoutGrid;r.style.padding=`${t}px`,r.style.gap=`${t}px`,r.querySelectorAll(".grid-cell").forEach(n=>{n.style.borderRadius=`${e}px`})}function Vt(){return a.layoutGrid,{element:a.layoutWrapper,options:{useCORS:!0,backgroundColor:null,scale:3}}}function mt(t){var e,r;t!==c.layout.currentLayoutId&&((e=a.layoutContainer.querySelector(".active"))==null||e.classList.remove("active"),(r=a.layoutContainer.querySelector(`[data-layout="${t}"]`))==null||r.classList.add("active"),xt(t),R())}function pt(t){delete c.layout.imagesData[t],ht(t),W()}function ft(t,e){if(!e)return;const r={...c.layout.imagesData[t]},n={...c.layout.imagesData[e]};r.src&&(r.position="50% 50%"),n.src&&(n.position="50% 50%"),c.layout.imagesData[t]=n,n.src?F(t,n.src,n.position):(delete c.layout.imagesData[t],ht(t)),c.layout.imagesData[e]=r,F(e,r.src,r.position)}function Kt(t){const e=L("div","grid-cell");e.id=t;const r=L("input");r.type="file",r.accept="image/*",r.id=`input-${t}`,r.multiple=!0,r.onchange=i=>gt(i.target.files,t);const n=L("div","upload-icon-container");n.innerHTML=ct.upload;const o=L("div","remove-image-btn");return o.innerHTML=ct.remove,o.onclick=i=>{i.stopPropagation(),pt(t)},e.append(n,r,o),e}const Jt=Object.freeze(Object.defineProperty({__proto__:null,activate:qt,applySharedStyles:ut,deactivate:Ht,getDownloadOptions:Vt,processFiles:gt,removeImage:pt,render:R,selectNewLayout:mt,shuffle:Nt,swapImages:ft},Symbol.toStringTag,{value:"Module"})),Qt={layout:Jt,stitching:$t};let k=null;function O(){return k}function V(t){c.currentMode===t&&k||(k&&k.deactivate(),c.currentMode=t,k=Qt[t],k.activate(),a.layoutModeBtn.classList.toggle("active",t==="layout"),a.stitchingModeBtn.classList.toggle("active",t==="stitching"),Zt(),W())}function Zt(){k&&k.render()}function I(t,e="success"){a.toast.textContent=t,a.toast.className="fixed bottom-5 right-5 text-white py-2 px-4 rounded-lg shadow-xl translate-x-[120%] transition-transform duration-300";const r={success:"bg-green-500",error:"bg-red-500",info:"bg-blue-500"};a.toast.classList.add(r[e]||"bg-gray-500"),a.toast.classList.remove("translate-x-[120%]"),setTimeout(()=>{a.toast.classList.add("translate-x-[120%]")},3e3)}const U=t=>{const e=parseInt(t.value,10);return isNaN(e)||e<0?0:e};function B(){var g;const t=a.spacingSlider.value,e=a.radiusSlider.value,r=a.colorPicker.value,n=U(a.borderTopInput),o=U(a.borderRightInput),i=U(a.borderBottomInput),l=U(a.borderLeftInput);c.shared.spacing=t,c.shared.radius=e,c.shared.bgColor=r,c.shared.borderWidths={top:n,right:o,bottom:i,left:l},a.spacingValue.textContent=t,a.radiusValue.textContent=e,[a.layoutWrapper,a.stitchingWrapper].forEach(d=>{c.shared.backgroundImage?(d.style.backgroundImage=`url(${c.shared.backgroundImage})`,d.style.backgroundSize="cover",d.style.backgroundPosition="center"):(d.style.backgroundImage="none",d.style.backgroundColor=c.shared.bgColor),d.style.paddingTop=`${c.shared.borderWidths.top}px`,d.style.paddingRight=`${c.shared.borderWidths.right}px`,d.style.paddingBottom=`${c.shared.borderWidths.bottom}px`,d.style.paddingLeft=`${c.shared.borderWidths.left}px`}),(g=O())==null||g.applySharedStyles()}function F(t,e,r="50% 50%"){const n=document.getElementById(t);if(!n)return;n.style.backgroundImage=`url(${e})`,n.style.backgroundPosition=r,n.classList.add("has-image");const o=n.querySelector(".upload-icon-container");o&&o.classList.add("hidden")}function ht(t){const e=document.getElementById(t);if(!e)return;e.style.backgroundImage="",e.classList.remove("has-image");const r=e.querySelector(".upload-icon-container");r&&r.classList.remove("hidden")}function W(){let t=0;c.currentMode==="layout"?t=Object.keys(c.layout.imagesData).length:t=c.stitching.images.length,a.shuffleBtn.disabled=t<2}(function(){const t="img.ops-coffee.cn",e=window.location.hostname;e&&e!==t&&e!=="localhost"&&e!=="12.0.0.1"&&(window.location.href=`https://${t}`)})();function te(){a.layoutContainer.innerHTML="";const t={};for(const e in j){const r=j[e];t[r.g]||(t[r.g]=[]),t[r.g].push({id:e,...r})}Object.keys(t).sort((e,r)=>e-r).forEach(e=>{const r=L("h4","layout-group-title");r.textContent=`${e} 张图片`,a.layoutContainer.appendChild(r);const n=L("div","layout-thumbnail-grid");t[e].forEach(o=>{const i=ee(o.id,o);o.id===c.layout.currentLayoutId&&i.classList.add("active"),n.appendChild(i)}),a.layoutContainer.appendChild(n)})}function ee(t,e){const r=L("div","layout-thumbnail");r.dataset.layout=t;const n=L("div","thumbnail-grid");return n.style.gridTemplateColumns=`repeat(${e.gr[1]}, 1fr)`,n.style.gridTemplateRows=`repeat(${e.gr[0]}, 1fr)`,(e.c||Array.from({length:e.gr[0]*e.gr[1]},()=>({r:1,c:1}))).forEach(i=>{const l=L("div","thumbnail-cell");l.style.gridRowEnd=`span ${i.r}`,l.style.gridColumnEnd=`span ${i.c}`,i.s&&(l.style.gridRowStart=i.s[0],l.style.gridColumnStart=i.s[1]),n.appendChild(l)}),r.appendChild(n),r}function re(){a.layoutModeBtn.addEventListener("click",()=>V("layout")),a.stitchingModeBtn.addEventListener("click",()=>V("stitching")),a.stitchingUploadBtn.addEventListener("click",()=>a.stitchingUploadInput.click()),a.stitchingUploadInput.addEventListener("change",u=>Ft(u.target.files)),a.stitchingDirectionBtns.addEventListener("click",u=>{const p=u.target.closest("button");p&&Tt(p.dataset.direction)}),a.layoutContainer.addEventListener("click",u=>{const p=u.target.closest(".layout-thumbnail");p&&(Rt(p.dataset.layout),document.getElementById("left-sidebar").classList.contains("is-open")&&d())}),a.aspectRatioBtns.addEventListener("click",u=>{const p=u.target.closest("button");p&&At(p)}),a.spacingSlider.addEventListener("input",B),a.radiusSlider.addEventListener("input",B),a.borderTopInput.addEventListener("input",B),a.borderRightInput.addEventListener("input",B),a.borderBottomInput.addEventListener("input",B),a.borderLeftInput.addEventListener("input",B),a.colorPicker.addEventListener("input",B),a.shuffleBtn.addEventListener("click",Mt),a.downloadBtn.addEventListener("click",Pt);const t=document.getElementById("bg-upload-input"),e=document.getElementById("upload-bg-btn"),r=document.getElementById("remove-bg-btn");e.addEventListener("click",()=>{t.click()}),t.addEventListener("change",u=>{u.target.files&&u.target.files[0]&&Dt(u.target.files[0])}),r.addEventListener("click",()=>{Ot()});let n;window.addEventListener("resize",()=>{clearTimeout(n),c.currentMode==="layout"&&(n=setTimeout(()=>{bt(async()=>{const{createGutters:u}=await Promise.resolve().then(()=>jt);return{createGutters:u}},void 0).then(({createGutters:u})=>{u()})},150))});const o=document.getElementById("toggle-left-sidebar"),i=document.getElementById("toggle-right-sidebar"),l=document.getElementById("left-sidebar"),s=document.getElementById("right-sidebar"),g=document.getElementById("mobile-overlay"),d=()=>{l.classList.remove("is-open"),s.classList.remove("is-open"),g.classList.add("hidden"),document.body.classList.remove("sidebar-open")};o.addEventListener("click",u=>{u.stopPropagation(),l.classList.toggle("is-open")?(s.classList.remove("is-open"),g.classList.remove("hidden"),document.body.classList.add("sidebar-open")):d()}),i.addEventListener("click",u=>{u.stopPropagation(),s.classList.toggle("is-open")?(l.classList.remove("is-open"),g.classList.remove("hidden"),document.body.classList.add("sidebar-open")):d()}),g.addEventListener("click",d),document.getElementById("stitching-placeholder").addEventListener("click",()=>{a.stitchingUploadInput.click()});const m=document.getElementById("app-container"),h=document.getElementById("pc-toggle-left"),b=document.getElementById("pc-toggle-right");h.addEventListener("click",()=>{m.classList.toggle("left-sidebar-collapsed")}),b.addEventListener("click",()=>{m.classList.toggle("right-sidebar-collapsed")}),ce(),document.getElementById("add-text-btn").addEventListener("click",Wt),document.getElementById("layout-grid").addEventListener("click",u=>{u.target.id==="layout-grid"&&P(null)}),document.addEventListener("click",u=>{if(!c.shared.selectedTextId)return;const p=u.target.closest(".text-element"),w=u.target.closest("#right-sidebar");!p&&!w&&P(null)}),document.getElementById("add-arrow-btn").addEventListener("click",Gt),document.addEventListener("click",u=>{const p=u.target.closest(".text-element-container"),w=u.target.closest(".arrow-container"),C=u.target.closest("#right-sidebar");c.shared.selectedTextId&&!p&&!C&&P(null),c.shared.selectedArrowId&&!w&&!C&&T(null)})}function ce(){const t=document.getElementById("layout-grid");let e={};function r(){e.startCell&&e.startCell.classList.remove("dragging"),e.activeCell&&e.activeCell.classList.remove("is-panning"),e={isMouseDown:!1,isPanning:!1,isDragging:!1,hasMoved:!1,startCell:null,activeCell:null,startX:0,startY:0,startBgPercentX:0,startBgPercentY:0},document.removeEventListener("mousemove",i),document.removeEventListener("mouseup",l)}function n(s,g){if(typeof s!="string")return 50;const d=s.trim();if(d.endsWith("%"))return parseFloat(d);if(d.endsWith("px"))return parseFloat(d)/g*100;switch(d){case"top":case"left":return 0;case"bottom":case"right":return 100;case"center":return 50}return 50}t.addEventListener("mousedown",s=>{if(s.button!==0)return;const g=s.target.closest(".grid-cell");!g||s.target.closest(".remove-image-btn")||(r(),e.isMouseDown=!0,e.startCell=g,e.startX=s.clientX,e.startY=s.clientY,document.addEventListener("mousemove",i),document.addEventListener("mouseup",l))});let o=null;function i(s){var g,d;if(e.isMouseDown){if(e.isPanning){const y=e.activeCell.getBoundingClientRect(),m=(s.clientX-e.startX)/y.width*100,h=(s.clientY-e.startY)/y.height*100;let b=e.startBgPercentX-m,u=e.startBgPercentY-h;b=Math.max(0,Math.min(100,b)),u=Math.max(0,Math.min(100,u)),e.activeCell.style.backgroundPosition=`${b}% ${u}%`;return}if(e.isDragging){const y=(g=document.elementFromPoint(s.clientX,s.clientY))==null?void 0:g.closest(".grid-cell");y!==o&&(o&&o.classList.remove("drag-over"),y&&y!==e.startCell&&y.classList.add("drag-over"),o=y);return}if(!e.hasMoved&&(Math.abs(s.clientX-e.startX)>5||Math.abs(s.clientY-e.startY)>5))if(e.hasMoved=!0,s.altKey&&e.startCell.classList.contains("has-image")){e.isPanning=!0,e.activeCell=e.startCell,e.activeCell.classList.add("is-panning");const y=e.activeCell.id,h=(((d=c.layout.imagesData[y])==null?void 0:d.position)||"50% 50%").split(" "),b=e.activeCell.getBoundingClientRect();e.startBgPercentX=n(h[0],b.width),e.startBgPercentY=n(h.length>1?h[1]:h[0],b.height)}else e.startCell.classList.contains("has-image")&&(e.isDragging=!0,e.startCell.classList.add("dragging"))}}function l(s){var g;if(e.isMouseDown){if(e.isPanning){const d=e.activeCell.id;c.layout.imagesData[d]&&(c.layout.imagesData[d].position=e.activeCell.style.backgroundPosition)}else if(e.isDragging){const d=(g=document.elementFromPoint(s.clientX,s.clientY))==null?void 0:g.closest(".grid-cell");d&&d!==e.startCell&&ft(e.startCell.id,d.id)}else if(!e.hasMoved){const d=e.startCell.querySelector('input[type="file"]');d&&d.click()}o&&(o.classList.remove("drag-over"),o=null),r()}}}function ne(){Lt(),te(),re(),V("layout");const t=a.aspectRatioBtns.querySelector('[data-ratio="1/1"]');t&&(t.classList.add("active"),a.layoutWrapper.style.aspectRatio="1/1"),B(),W(),console.log("%c 免费在线拼图工具 %c by ops-coffee.cn ","background: #0052cc; color: #fff; padding: 5px; border-radius: 5px 0 0 5px;","background: #f4f5f7; color: #42526e; padding: 5px; border-radius: 0 5px 5px 0;"),console.log("感谢使用！如果您对这个工具有任何建议，欢迎联系我们。微信公众号搜索：运维咖啡吧")}document.addEventListener("DOMContentLoaded",ne);
